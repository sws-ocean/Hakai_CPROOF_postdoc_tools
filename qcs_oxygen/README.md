# QCS Oxygen Analysis

This directory contains MATLAB scripts used in the analysis of long-term oxygen variability on the Queen Charlotte Sound (QCS) shelf. The analyses integrate time series data, mooring observations, upwelling indices, and estimates of biological oxygen demand. This is intended as reference material, not an exhaustive directory of all resources used in the manuscript.

## Contents

### Scripts

- `AOUallTS.m`  
  Loads and analyzes Apparent Oxygen Utilization (AOU) time series across multiple sources.

- `climate.m`  
  Loads PDO and NPGO climate indices for correlation with shelf oxygen trends.

- `DO_1990_2024_QCS_TS_R1.m`  
  Main driver script for processing and visualizing 1990–2024 dissolved oxygen time series across the QCS shelf.

- `hypoxia_R1.m`  
  Identifies and quantifies hypoxic events (O₂ < 61 μmol/kg), and computes shelf-wide extent and duration.

- `map_R1.m`  
  Creates QCS map and plots measurement locations.
  
- `moorings_R1.m`  
  Processes and visualizes oxygen and hydrographic data from HAK1 and SCOTT2 shelf moorings.

- `QCSwind.m`  
  Loads and processes NARR wind forcing.

- `shelfAOU.m`  
  Calculates time series and spatial patterns of shelf AOU anomalies and their trends.

- `sourceWatersR1.m`  
  Correlates offshore source waters to shelf oxygen variability.

- `upwelling.m`  
  Plots upwelling characteristics in relation to oxygen variability.

### Data

This directory assumes pre-processed observational are available locally.

### Output

Figures and summary tables are generated by several scripts (notably `DO_1990_2024_QCS_TS_R1.m`, `hypoxia_R1.m`, and `shelfAOU.m`). Figures are saved in vector PDF format suitable for inclusion in manuscripts.

## Citation

This folder contains some of the more important scripts used in the manuscript titled "Dissolved oxygen variability on the Canadian Pacific shelf: trends, drivers, and projections in the context of emerging hypoxia in Queen Charlotte Sound" (in review, [preprint here](https://doi.org/10.22541/essoar.174117442.29335954/v1)). Please cite this paper if you use these scripts. 


